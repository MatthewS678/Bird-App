[[extend 'layout.html']]

<style>
[v-cloak] {
    display: none;
}
</style>

<div id="app">
    <div>
        <h1>Region Information</h1>
        <button @click="showRegionInfo">Show Region Info</button>

        <div v-if="regionInfo">
            <h2>Species List</h2>
            <ul>
                <li v-for="species in regionInfo.species" :key="species.name">
                    {{ species.name }} - Checklists: {{ species.checklists }} | Sightings: {{ species.sightings }}
                    <button @click="showGraph(species)">Show Graph</button>
                </li>
            </ul>

            <div id="graph"></div>

            <h2>Top Contributors</h2>
            <ul>
                <li v-for="contributor in regionInfo.topContributors" :key="contributor.name">
                    {{ contributor.name }} - Contributions: {{ contributor.contributions }}
                </li>
            </ul>
        </div>

        <div v-if="rectangleCoordinates">
            <h2>Rectangle Coordinates</h2>
            <p>Southwest: {{ rectangleCoordinates.southwest.lat }}, {{ rectangleCoordinates.southwest.lng }}</p>
            <p>Northeast: {{ rectangleCoordinates.northeast.lat }}, {{ rectangleCoordinates.northeast.lng }}</p>
        </div>
    </div>
</div>

[[block page_scripts]]
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="js/location.js"></script>
<script>
    (g => {
      var h, a, k, p = "The Google Maps JavaScript API", c = "google", l = "importLibrary", q = "__ib__", m = document, b = window;
      b = b[c] || (b[c] = {});
      var d = b.maps || (b.maps = {}),
        r = new Set(),
        e = new URLSearchParams(),
        u = () => h || (h = new Promise(async (f, n) => {
          await (a = m.createElement("script"));
          e.set("libraries", [...r, "drawing"].join(","));
          for (k in g) e.set(k.replace(/[A-Z]/g, t => "_" + t[0].toLowerCase()), g[k]);
          e.set("callback", c + ".maps." + q);
          a.src = `https://maps.${c}apis.com/maps/api/js?` + e;
          d[q] = f;
          a.onerror = () => h = n(Error(p + " could not load."));
          a.nonce = m.querySelector("script[nonce]")?.nonce || "";
          m.head.append(a);
        }));
      d[l] ? console.warn(p + " only loads once. Ignoring:", g) : d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n));
    })({
      key: "***REDACTED***",
      v: "weekly",
    });
  </script>
[[end]]
